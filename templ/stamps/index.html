{% extends "base.html" %}
{% block main %}
<h1><span class="fa fa-heartbeat"></span> Stamps</h1>

<ol class="breadcrumb">
    <li><a href="{{ url_for(['StampsController', 'index']) }}">Stamps</a></li>
    {% if request.host %}
    <li><a href="{{ url_for(['StampsController', 'index']) }}?host={{ request.host }}">{{ request.host }}</a></li>
    {% endif %}
</ol>

<div class="panel panel-default">
    <div class="panel-heading clearfix">
        <h3 class="panel-title">Filter</h3>
    </div>
    <div class="panel-body">
        <form action="{{ url_for(['StampsController', 'index']) }}" method="get" class="form-horizontal">
            <div class="form-group">
                <label for="inputHost" class="col-sm-2 control-label">Host:</label>
                <div class="col-sm-10">
                    <input type="text" name="host" id="inputHost" value="{{ request.host }}" class="form-control" />
                </div>
            </div>

            <div class="form-group">
                <label for="inputStamp" class="col-sm-2 control-label">Stamp:</label>
                <div class="col-sm-10">
                    <input type="text" name="stamp" id="inputStamp" value="{{ request.stamp }}" class="form-control" />
                </div>
            </div>

            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <input type="submit" value="Show" class="btn btn-primary" />
                </div>
            </div>
        </form>
    </div>
</div>

<div class="table-responsive">
    <table class="table table-compacted table-hover table-striped">
        <thead>
            <tr>
                <th>Stamp</th>
                <th>Host</th>
                <th>Last stamp</th>
                <th>Alert period</th>
            </tr>
        </thead>

        <tbody>
            {% for stamp in stamps %}
                <tr{% if stamp.in_alert %} class="danger"{% endif %}>
                    <td><a href="{{ url_for(['StampsController', 'detail'], {'id': stamp.id}) }}"><span class="glyphicon glyphicon-search" style="vertical-align: text-top"></span> {{ stamp.stamp }}</a></td>
                    <td><a href="{{ url_for(['StampsController', 'index']) }}?host={{ stamp.hostname }}">{{ stamp.hostname }}</a></td>
                    <td>{{ stamp.timestamp|datetime("Y-m-d G:i:s") }}</td>
                    <td>{{ stamp.alert_after|duration }}</td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="3"><div class="well">No stamps matching filter criteria.</div></td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}