{% extends "base.html" %}
{% block main %}
<h1><span class="fa fa-hand-o-right"></span> Checks</h1>

<ol class="breadcrumb">
    <li><a href="{{ url_for(['ChecksController', 'index']) }} ">Checks</a></li>
</ol>

<div class="btn-group" role="group">
    <a href="{{ url_for(['ChecksController', 'add']) }}" class="btn btn-default">Add</a>
</div>

<div class="panel panel-default">
    <div class="panel-heading clearfix">
        <h3 class="panel-title">Filter</h3>
        <ul class="panel-tool-options">
            <li><a data-toggle="collapse" href="#filterBody" aria-expanded="{% if get.name or get.host or get.type %}true{% else %}false{% endif %}" aria-controls="filterBody"><span class="fa fa-chevron-down"></span></a></li>
        </ul>
    </div>
    <div class="collapse{% if get.name or get.host or get.type %} in{% endif %}" id="filterBody">
        <div class="panel-body">
            <form action="{{ url_for(['ChecksController', 'index']) }}" method="get" class="form-horizontal">
                <div class="form-group">
                    <label for="inputName" class="col-sm-2 control-label">Name:</label>
                    <div class="col-sm-10">
                        <input type="text" name="name" id="inputName" value="{{ request.name }}" class="form-control" />
                    </div>
                </div>

                <div class="form-group">
                    <label for="inputHost" class="col-sm-2 control-label">Host:</label>
                    <div class="col-sm-10">
                        <input type="text" name="host" id="inputHost" value="{{ request.host }}" class="form-control" />
                    </div>
                </div>

                <div class="form-group">
                    <label for="inputType" class="col-sm-2 control-label">Type:</label>
                    <div class="col-sm-10">
                        <select name="type" id="inputType" class="form-control">
                            <option value=""{% if not request.type %} selected{% endif %}></option>
                            {% for type in types %}
                                <option value="{{ type.id }}"{% if type.id == request.type %} selected{% endif %}>{{ type.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                        <input type="submit" value="Show" class="btn btn-primary" />
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<table class="table table-striped table-compacted table-hover">
    <thead>
        <tr>
            <th colspan="2">{{ "Name"|sorted("name", true) }}</th>
            <th>{{ "Host"|sorted("hostname") }}</th>
            <th>{{ "Type"|sorted("type") }}</th>
            <th>{{ "Interval"|sorted("interval") }}</th>
            <th class="td-shrink"></th>
        </tr>
    </thead>

    <tbody>
        {% for check in checks %}
            <tr{% if check.alerts > 0 %} class="danger"{% endif %}>
                <td><a href="{{ url_for(['ChecksController', 'detail'], {'id': check.id}) }}"><span class="fa fa-search"></span> {{ check.name }}</a></td>
                <td>{% if check.alerts > 0 %}<span class="label label-danger">{{ check.alerts }}</span>{% endif %}</td>
                <td>{{ check.hostname }}</td>
                <td>{{ check.type }}</td>
                <td>{{ check.interval|duration }}</td>
                <td class="td-shrink">
                    {% if check.enabled %}
                        <a href="{{ url_for(['ChecksController', 'toggle'], {'id': check.id}) }}" class="btn btn-default btn-sm"><span class="text-success" title="Click to pause."><span class="fa fa-play"></span> Active</span></a>
                    {% else %}
                        <a href="{{ url_for(['ChecksController', 'toggle'], {'id': check.id}) }}" class="btn btn-default btn-sm"><span class="text-muted" title="Click to activate."><span class="fa fa-pause"></span> Paused</span></a>
                    {% endif %}
                    <a href="{{ url_for(['ChecksController', 'edit'], {'id': check.id}) }}" class="btn btn-default btn-sm"><span class="fa fa-edit"></span> Modify</a>
                    <a href="{{ url_for(['ChecksController', 'remove'], {'id': check.id}) }}" class="btn btn-default btn-sm" onclick="return confirm('Do you really want to remove this check?')"><span class="fa fa-remove"></span> Remove</a>
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}